<%- include('partials/header', {title: title}) %>

<h1 class="mb-4">Exercise Feedback</h1>

<div class="card mb-4">
  <div class="card-header bg-success text-white">
    <h5 class="card-title mb-0">Your Submission</h5>
  </div>
  <div class="card-body">
    <p><strong>Your sentence:</strong> <%= sentence %></p>
    <p><strong>Required words:</strong> <%= words %></p>
    
    <% if (typeof wordUsageCheck !== 'undefined') { %>
      <div class="alert <%= wordUsageCheck.allWordsUsed ? 'alert-success' : 'alert-danger' %> mt-3">
        <% if (wordUsageCheck.allWordsUsed) { %>
          <p><i class="bi bi-check-circle-fill"></i> <strong>Word usage:</strong> You correctly used all the required words!</p>
        <% } else { %>
          <p><i class="bi bi-exclamation-triangle-fill"></i> <strong>Word usage:</strong> You did not use all the required words. Missing: <%= wordUsageCheck.missingWords.join(', ') %></p>
        <% } %>
      </div>
    <% } %>
    
    <hr>
    
    <div class="alert <%= typeof feedbackClass !== 'undefined' ? feedbackClass : 'alert-info' %>">
      <% if (typeof score !== 'undefined') { %>
        <div class="mb-2">
          <strong>Score: </strong>
          <% for(let i = 1; i <= 5; i++) { %>
            <i class="bi <%= i <= score ? 'bi-star-fill' : 'bi-star' %>"></i>
          <% } %>
        </div>
      <% } %>
      <p><strong>Feedback:</strong> <%= feedback %></p>
      
      <% if (typeof suggestions !== 'undefined' && suggestions.length > 0) { %>
        <div class="mt-3">
          <strong>Suggestions for improvement:</strong>
          <ul class="mt-2">
            <% suggestions.forEach(function(suggestion) { %>
              <li><%= suggestion %></li>
            <% }); %>
          </ul>
        </div>
      <% } %>
    </div>
    
    <div class="d-flex justify-content-between mt-4">
      <a href="/writing" class="btn btn-secondary">Back to Writing</a>
      <div>
        <a href="/statistics" class="btn btn-info me-2">View My Statistics</a>
        <a href="/writing/exercise" class="btn btn-primary">Try Another Exercise</a>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>